<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Examples</title>
<link rel="stylesheet" href="../style/css.css">
<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="../style/house.css">
<script type="text/javascript" src="../js/jquery.js"></script>
<script src="../bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/Dialog/jquery.artDialog.js?skin=aero"></script>
<script type="text/javascript" src="../js/Dialog/plugins/iframeTools.js"></script>
<script type="text/javascript" src="../js/buildHtml.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.4"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/SearchInfoWindow/1.4/src/SearchInfoWindow_min.js"></script>
<link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.4/src/SearchInfoWindow_min.css" />
<script src="areamap.js"></script>
<script type="text/javascript">
var lngs="117.260429";
var lats="31.881385";
var areas = "华府俊园";
var address = "";
var dataArr;
function getAreaList(search){
  var url='/zb/areas/list';
  $.ajax({
    type: 'POST',
    url: url,
    data:search,
    success: function(data){
      var getStr=JSON.parse(data);
      dataArr = getStr['page']['data'];
      buildHtmlWithJsonArray("id_House_list",dataArr);
    }
  });
}

function onSubmit_Form(){
  $('form[name=form1]').on('submit', function(event) {
  var search = $("form[name=form1]").serialize(); //自动将form表单封装成json
    getAreaList(search);
    return false;
  });
}

function openEdit(rowIndex){
  var json = dataArr[rowIndex];
  id=json['id'];
  lats=json['maplat'];
  lngs=json['maplng']
  areas = json['name'];
  address = json['address'];
  var tmp = [];
  tmp.push(json);
  buildHtmlWithJsonArray('info',tmp);

  var mapDiv = $('#map');
  mapDiv.css({"width":"1080px","height":"600px"});
  addMarker();
  // initMap();
  art.dialog.open('areaedit.html?id='+id,{
    padding: 0,
    marging: 0,
    width: 1080,
    lock:true,
    height: 600,
    title: '地图',
    close:function(){
      $('#mapDiv').css('opacity',0);
    }
  });
  // mapDiv.css('opacity',1);
//  $('#mapDiv').css('opacity',1);
//  mapDiv.parent()[0].parentElement.style.width='100%';
//  mapDiv.parent()[0].parentElement.style.height='100%'
  // mapDiv.css({"width":"100%","height":"100%"});
}
$(function(){
  onSubmit_Form();
  getAreaList();
  initMap();//创建和初始化地图
});

</script>
<style type="text/css">
  .table{ margin-bottom: 0px;}
</style>
</head>
<body class="hlist bodyer">

<div class="header" style="position:relative;height:50px;width:100%">
    <div class="btn-group">
      <button type="submit" class="btn btn-primary">添加</button>
    </div>
    <form name="form1">
    <div class="input-group input-group-max">
      <span class="input-group-addon">楼盘名称</span>
      <input type="text" class="form-control" name="search">
    </div>
    <div class="btn-group">
      <button type="submit" class="btn btn-primary">搜索</button>
    </div>
    </form>
</div>
<div class="mainer" style="position:relative;width:100%">
  <table class="table table-hover .table_bodyer" >
    <thead>
      <th>编号</th>
      <th>区域</th>
      <th>楼盘名称</th>
      <th>地址</th>
      <th>简拼</th>
      <th>全拼</th>
      <th>操作</th>
    </thead>
    <tbody id="id_House_list">
    <tr>
      <td>${id}</td>
      <td>${quyu}</td>
      <td>${name}</td>
      <td>${address}</td>
      <td>${pyShort}</td>
      <td>${pinyin}</td>
      <td><a href="javascript:void(0)" onclick="openEdit(${rowIndex})">编辑<span>${maplat},</span><span>${maplng}</span></a></td>
      
    </tr>
    </tbody>
  </table>
</div>

</body>
</html>